{"parameters":[{"name":"spending","type":"long","nullable":false,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"high_value_flag","type":"integer","nullable":false,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"is_recent_order","type":"integer","nullable":false,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"last_purchase_date","type":"date","nullable":false,"metadata":{"description":"","mappings":[],"tags":[]}}],"outputs":[{"name":"promo_offer"}],"data":[{"inputs":[{"name":"spending","expression":{"format":"sql","expression":">700"}},{"name":"high_value_flag","expression":{"format":"sql","expression":"=1"}},{"name":"is_recent_order","expression":{"format":"sql","expression":""}},{"name":"last_purchase_date","expression":{"format":"sql","expression":""}}],"outputs":[{"name":"promo_offer","expression":{"format":"sql","expression":"'25% Discount'"}}],"description":"25% discount if spending is greater than 700 and flagged as HVC."},{"inputs":[{"name":"spending","expression":{"format":"sql","expression":">500"}},{"name":"high_value_flag","expression":{"format":"sql","expression":""}},{"name":"is_recent_order","expression":{"format":"sql","expression":"=1"}},{"name":"last_purchase_date","expression":{"format":"sql","expression":""}}],"outputs":[{"name":"promo_offer","expression":{"format":"sql","expression":"'Buy one get one free'"}}],"description":"Buy one get one free for spenders who have made purchases in last 30 days."},{"inputs":[{"name":"spending","expression":{"format":"sql","expression":">500"}},{"name":"high_value_flag","expression":{"format":"sql","expression":""}},{"name":"is_recent_order","expression":{"format":"sql","expression":""}},{"name":"last_purchase_date","expression":{"format":"sql","expression":""}}],"outputs":[{"name":"promo_offer","expression":{"format":"sql","expression":"'15% discount'"}}],"description":"15% discount if spending greater than 500."},{"inputs":[{"name":"spending","expression":{"format":"sql","expression":">300"}},{"name":"high_value_flag","expression":{"format":"sql","expression":""}},{"name":"is_recent_order","expression":{"format":"sql","expression":""}},{"name":"last_purchase_date","expression":{"format":"sql","expression":""}}],"outputs":[{"name":"promo_offer","expression":{"format":"sql","expression":"'10% Discount'"}}],"description":"10% discount if spending is above 300."},{"inputs":[{"name":"spending","expression":{"format":"sql","expression":">100"}},{"name":"high_value_flag","expression":{"format":"sql","expression":""}},{"name":"is_recent_order","expression":{"format":"sql","expression":""}},{"name":"last_purchase_date","expression":{"format":"sql","expression":""}}],"outputs":[{"name":"promo_offer","expression":{"format":"sql","expression":"'5% Discount'"}}],"description":"5% discount globally"},{"inputs":[{"name":"spending","expression":{"format":"sql","expression":""}},{"name":"high_value_flag","expression":{"format":"sql","expression":""}},{"name":"is_recent_order","expression":{"format":"sql","expression":""}},{"name":"last_purchase_date","expression":{"format":"sql","expression":">= '2024-12-01' and last_purchase_date <= '2024-12-31'"}}],"outputs":[{"name":"promo_offer","expression":{"format":"sql","expression":"'Free two-day shipping'"}}],"description":"Free two-day shipping for customers who ordered in Dec 2024."},{"inputs":[{"name":"spending","expression":{"format":"sql","expression":""}},{"name":"high_value_flag","expression":{"format":"sql","expression":""}},{"name":"is_recent_order","expression":{"format":"sql","expression":""}},{"name":"last_purchase_date","expression":{"format":"sql","expression":""}}],"outputs":[{"name":"promo_offer","expression":{"format":"sql","expression":"'No Discount'"}}],"description":"No discount for non customers."}],"description":"Create promo offers for customers based on spend amount and recency of latest purchase"}